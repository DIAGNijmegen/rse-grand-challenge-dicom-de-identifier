# Unit of Knowledge - Template

Please replace this readme with information about your experiment. Include:

* The project's name
* TRAC ticket number
* Point to the jupyter notebook that will be your entrypoint for your unit of knowledge
* Author name
* **Instructions on building your docker containers:**
    * Include external paths to external experiment data directories that need to be added to the repository before building.
    * Describe if extra, special environment variables/arguments need to be defined in order to build your container.

## Converting the template into a Unit of Knowledge

1. Clone this repository and use it to create a new Unit of Knowledge repository on [https://github.com/DIAGNijmegen](https://github.com/DIAGNijmegen). For details see [SOP 7335](https://repos.diagnijmegen.nl/trac/ticket/7335).

2. Replace this README.md with a short description of your experiment (see above).

3. Add your experiment code to the new repository.

    - Modify `entrypoint.ipynb` and add a technical description of your experiment. Explain:
        - How to execute your code
        - The most important data structures of your experiment
        - How to apply your experiment to a dataset (if applicable)
        - See [SOP 7330](https://repos.diagnijmegen.nl/trac/ticket/7330)
    - Add the name of your jupyter notebook to the README.md, designate its name clearly.

4. Configure your `prepare_data.conf`-file and create a `filelist.txt`-file in the root of the repository

    - You can use the template `prepare_data.conf.example`. Make sure this file is deleted after you wrote your own `prepare_data.conf`-file.
        - The configuration file should contain the location of the data on the DIAG datashares, the location of the `filelist.txt`-file, and if data verification through MD5 is required. 
    - Valid `filelist.txt`-files can be generated by navigating to a folder you want to recursively index and run one of the following commands:
        - The following command creates a filelist.txt which can be used to check for file existence and for file integrity through MD5 (preferred method but it may take a while)
            - `find . -type f \( -name \* ! -name "filelist.txt" \) -print0 | xargs -0 md5sum > ./filelist.txt`
        - The following command creates a filelist.txt which can be used to check for file existence only (if the accumulative filesize of the files to copy exceeds 1TB)
            - `find . -type f \( -name \* ! -name "filelist.txt" \) > ./filelist.txt`
    - Verify that your files are properly configured by manually invoking `prepare_data.sh --dry-run` 

5. Rename the `Dockerfile.template` files in the subfolders 'uok', 'processor', and 'evaluation' to `Dockerfile` and fill in the correct build rules. Test if your docker builds and commit it to the DIAG regsitry. See [SOP 7351](https://repos.diagnijmegen.nl/trac/ticket/7351).

6. Ask for validation of your Unit of Knowledge.

